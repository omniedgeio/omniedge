app-id: io.omniedge.desktop
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: omniedge

finish-args:
  # Network access for VPN
  - --share=network
  # System network configuration
  - --system-talk-name=org.freedesktop.NetworkManager
  # Access to system D-Bus for helper service
  - --system-talk-name=io.omniedge.helper
  # X11/Wayland display
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  # Desktop notifications
  - --talk-name=org.freedesktop.Notifications
  # System tray icon
  - --talk-name=org.kde.StatusNotifierWatcher
  # File access for config
  - --filesystem=~/.config/OmniEdge:create

modules:
  - name: omniedge
    buildsystem: simple
    build-commands:
      - install -Dm755 omniedge /app/bin/omniedge
      - install -Dm755 omniedge-helper /app/bin/omniedge-helper
      - install -Dm644 omniedge.desktop /app/share/applications/io.omniedge.desktop.desktop
      - install -Dm644 omniedge.png /app/share/icons/hicolor/128x128/apps/io.omniedge.desktop.png
    sources:
      - type: file
        path: omniedge
      - type: file
        path: omniedge-helper
      - type: file
        path: omniedge.desktop
      - type: file
        path: omniedge.png
